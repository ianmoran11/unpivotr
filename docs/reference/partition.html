<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Divide a grid of cells into partitions containing individual tables — partition • unpivotr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Divide a grid of cells into partitions containing individual tables — partition" />

<meta property="og:description" content="Given the positions of corner cells that mark individual tables in a single
spreadsheet, partion() works out which table cells belong to which corner
cells.  The individual tables can then be worked on independently.
partition() partitions along both dimensions (rows and columns) at once.
partition_dim() partitions along one dimension at a time." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-45097885-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-45097885-5');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unpivotr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/compass-directions.html">Compass Directions</a>
    </li>
    <li>
      <a href="../articles/html.html">HTML Tables</a>
    </li>
    <li>
      <a href="../articles/small-multiples.html">Small Multiples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nacnudus/unpivotr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Divide a grid of cells into partitions containing individual tables</h1>
    <small class="dont-index">Source: <a href='https://github.com/nacnudus/unpivotr/blob/master/R/partition.R'><code>R/partition.R</code></a></small>
    <div class="hidden name"><code>partition.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Given the positions of corner cells that mark individual tables in a single
spreadsheet, <code>partion()</code> works out which table cells belong to which corner
cells.  The individual tables can then be worked on independently.</p>
<p><code>partition()</code> partitions along both dimensions (rows and columns) at once.
<code>partition_dim()</code> partitions along one dimension at a time.</p>
    
    </div>

    <pre class="usage"><span class='fu'>partition</span>(<span class='no'>cells</span>, <span class='no'>corners</span>, <span class='kw'>align</span> <span class='kw'>=</span> <span class='st'>"top_left"</span>, <span class='kw'>nest</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>strict</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>partition_dim</span>(<span class='no'>positions</span>, <span class='no'>cutpoints</span>, <span class='kw'>bound</span> <span class='kw'>=</span> <span class='st'>"upper"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cells</th>
      <td><p>Data frame or tbl, the cells to be partitioned, from
<code><a href='as_cells.html'>as_cells()</a></code> or <code><a href='http://www.rdocumentation.org/packages/tidyxl/topics/xlsx_cells'>tidyxl::xlsx_cells()</a></code>.</p></td>
    </tr>
    <tr>
      <th>corners</th>
      <td><p>usually a subset of <code>cells</code>, being the corners of individual
tables.  Can also be cells that aren't among <code>cells</code>, in which case see the
<code>strict</code> argument.</p></td>
    </tr>
    <tr>
      <th>align</th>
      <td><p>Character, the position of the corner cells relative to their
tables, one of <code>"top-left"</code> (default), <code>"top-right"</code>, <code>"bottom-left"</code>,
<code>"bottom-right"</code>.</p></td>
    </tr>
    <tr>
      <th>nest</th>
      <td><p>Logical, whether to nest the partitions in a list-column of data
frames.</p></td>
    </tr>
    <tr>
      <th>strict</th>
      <td><p>Logical, whether to omit partitions that don't contain a corner
cell.</p></td>
    </tr>
    <tr>
      <th>positions</th>
      <td><p>Integer vector, the positions of cells (either the row
position or the column position), which are to be grouped between
cutpoints.</p></td>
    </tr>
    <tr>
      <th>cutpoints</th>
      <td><p>Integer vector. The <code>positions</code> will be separated into
groups either side of each cutpoint.</p></td>
    </tr>
    <tr>
      <th>bound</th>
      <td><p>One of <code>"upper"</code> or <code>"lower"</code>, controls whether cells that lie
on a cutpoint are should be grouped with cells below or above the cutpoint.
For example, if column 5 is a cutpoint, and a cell is in column 5,
<code>"lower"</code> would group it with cells in columns 1 to 4, whereas <code>"upper"</code>
would group it with cells in columns 6 to 10.  This is so that you can use
cells at the bottom or the right-hand side of a table as the cutpoints
(either of which would be 'upper' bounds because row and column numbers
count from 1 in the top-left row and column).  When <code>"upper"</code>, any
<code>cell_positions</code> above the first cutpoint will be in group 0; when
<code>"lower"</code>, any <code>cell_positions</code> below the final cutpoint will be 0.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>partition_dim()</code> returns an integer vector, numbering the groups of
cells.  Group 0 represents the cells above the first cutpoint (when <code>bound = "upper"</code>), or below the first cutpoint (when <code>bound = "lower"</code>).  The
other groups are numbered from 1, where group 1 is adjacent to group 0.</p>
<p><code>partition_dim()</code> returns an integer vector, numbering the groups of cells.
Group 0 represents the cells above the first cutpoint (when <code>bound = "upper"</code>), or below the first cutpoint (when <code>bound = "lower"</code>).  The other
groups are numbered from 1, where group 1 is adjacent to group 0.  Divide a
grid of cells into chunks along both dimensions</p>
    
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    <ul>
<li><p><code>partition_dim</code>: Divide a grid of cells into chunks along one dimension</p></li>
</ul>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># The `purpose` dataset, represented in four summary tables</span>
<span class='no'>multiples</span> <span class='kw'>&lt;-</span> <span class='no'>purpose</span>$<span class='no'>small_multiples</span>
<span class='fu'><a href='rectify.html'>rectify</a></span>(<span class='no'>multiples</span>, <span class='no'>character</span>, <span class='no'>numeric</span>)</div><div class='output co'>#&gt; # A tibble: 14 x 6
#&gt;    `row/col` `1(A)`                     `2(B)` `3(C)` `4(D)`            `5(E)`
#&gt;        &lt;int&gt; &lt;chr&gt;                      &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;             &lt;chr&gt; 
#&gt;  1         1 Postgraduate qualification &lt;NA&gt;   &lt;NA&gt;   Bachelor's degree &lt;NA&gt;  
#&gt;  2         2 Sex                        Value  &lt;NA&gt;   Sex               Value 
#&gt;  3         3 Female                     &lt;NA&gt;   &lt;NA&gt;   Female            &lt;NA&gt;  
#&gt;  4         4 Male                       &lt;NA&gt;   &lt;NA&gt;   Male              &lt;NA&gt;  
#&gt;  5         5 &lt;NA&gt;                       &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;              &lt;NA&gt;  
#&gt;  6         6 Diploma                    &lt;NA&gt;   &lt;NA&gt;   Certificate       &lt;NA&gt;  
#&gt;  7         7 Sex                        Value  &lt;NA&gt;   Sex               Value 
#&gt;  8         8 Female                     &lt;NA&gt;   &lt;NA&gt;   Female            &lt;NA&gt;  
#&gt;  9         9 Male                       &lt;NA&gt;   &lt;NA&gt;   Male              &lt;NA&gt;  
#&gt; 10        10 &lt;NA&gt;                       &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;              &lt;NA&gt;  
#&gt; 11        11 No Qualification           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;              &lt;NA&gt;  
#&gt; 12        12 Sex                        Value  &lt;NA&gt;   &lt;NA&gt;              &lt;NA&gt;  
#&gt; 13        13 Female                     &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;              &lt;NA&gt;  
#&gt; 14        14 Male                       &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;              &lt;NA&gt;  </div><div class='input'>
<span class='co'># The same thing in its raw 'melted' form that can be filtered</span>
<span class='no'>multiples</span></div><div class='output co'>#&gt;    row col data_type                  character numeric
#&gt; 1    1   1 character Postgraduate qualification      NA
#&gt; 2    1   2     blank                       &lt;NA&gt;      NA
#&gt; 3    1   4 character          Bachelor's degree      NA
#&gt; 4    1   5     blank                       &lt;NA&gt;      NA
#&gt; 5    2   1 character                        Sex      NA
#&gt; 6    2   2 character                      Value      NA
#&gt; 7    2   4 character                        Sex      NA
#&gt; 8    2   5 character                      Value      NA
#&gt; 9    3   1 character                     Female      NA
#&gt; 10   3   2   numeric                       &lt;NA&gt;  171000
#&gt; 11   3   4 character                     Female      NA
#&gt; 12   3   5   numeric                       &lt;NA&gt;  275000
#&gt; 13   4   1 character                       Male      NA
#&gt; 14   4   2   numeric                       &lt;NA&gt;  159000
#&gt; 15   4   4 character                       Male      NA
#&gt; 16   4   5   numeric                       &lt;NA&gt;  200000
#&gt; 17   6   1 character                    Diploma      NA
#&gt; 18   6   2     blank                       &lt;NA&gt;      NA
#&gt; 19   6   4 character                Certificate      NA
#&gt; 20   6   5     blank                       &lt;NA&gt;      NA
#&gt; 21   7   1 character                        Sex      NA
#&gt; 22   7   2 character                      Value      NA
#&gt; 23   7   4 character                        Sex      NA
#&gt; 24   7   5 character                      Value      NA
#&gt; 25   8   1 character                     Female      NA
#&gt; 26   8   2   numeric                       &lt;NA&gt;  210000
#&gt; 27   8   4 character                     Female      NA
#&gt; 28   8   5   numeric                       &lt;NA&gt;  732000
#&gt; 29   9   1 character                       Male      NA
#&gt; 30   9   2   numeric                       &lt;NA&gt;  173000
#&gt; 31   9   4 character                       Male      NA
#&gt; 32   9   5   numeric                       &lt;NA&gt;  807000
#&gt; 33  11   1 character           No Qualification      NA
#&gt; 34  11   2     blank                       &lt;NA&gt;      NA
#&gt; 35  12   1 character                        Sex      NA
#&gt; 36  12   2 character                      Value      NA
#&gt; 37  13   1 character                     Female      NA
#&gt; 38  13   2   numeric                       &lt;NA&gt;  344000
#&gt; 39  14   1 character                       Male      NA
#&gt; 40  14   2   numeric                       &lt;NA&gt;  287000</div><div class='input'>
<span class='co'># First, find the cells that mark a corner of each table</span>
<span class='no'>corners</span> <span class='kw'>&lt;-</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>multiples</span>,
                !<span class='fu'>is.na</span>(<span class='no'>character</span>),
                !(<span class='no'>character</span> <span class='kw'>%in%</span> <span class='fu'>c</span>(<span class='st'>"Sex"</span>, <span class='st'>"Value"</span>, <span class='st'>"Female"</span>, <span class='st'>"Male"</span>)))

<span class='co'># Then find out which cells fall into which partition</span>
<span class='fu'>partition</span>(<span class='no'>multiples</span>, <span class='no'>corners</span>)</div><div class='output co'>#&gt; # A tibble: 5 x 6
#&gt;   corner_row corner_col cells           data_type character              numeric
#&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;list&gt;          &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
#&gt; 1          1          1 &lt;tibble [8 × 5… character Postgraduate qualific…      NA
#&gt; 2          1          4 &lt;tibble [8 × 5… character Bachelor's degree           NA
#&gt; 3          6          1 &lt;tibble [8 × 5… character Diploma                     NA
#&gt; 4          6          4 &lt;tibble [8 × 5… character Certificate                 NA
#&gt; 5         11          1 &lt;tibble [8 × 5… character No Qualification            NA</div><div class='input'>
<span class='co'># You can also use bottom-left corners (or top-right or bottom-right)</span>
<span class='no'>bl_corners</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>multiples</span>, <span class='no'>character</span> <span class='kw'>==</span> <span class='st'>"Male"</span>)
<span class='fu'>partition</span>(<span class='no'>multiples</span>, <span class='no'>bl_corners</span>, <span class='kw'>align</span> <span class='kw'>=</span> <span class='st'>"bottom_left"</span>)</div><div class='output co'>#&gt; # A tibble: 5 x 6
#&gt;   corner_row corner_col cells            data_type character numeric
#&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;list&gt;           &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
#&gt; 1          4          1 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 2          4          4 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 3          9          1 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 4          9          4 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 5         14          1 &lt;tibble [8 × 5]&gt; character Male           NA</div><div class='input'>
<span class='co'># To complete the grid even when not all corners are supplied, use `strict`</span>
<span class='no'>bl_corners</span> <span class='kw'>&lt;-</span> <span class='no'>bl_corners</span>[-<span class='fl'>1</span>, ]
<span class='fu'>partition</span>(<span class='no'>multiples</span>, <span class='no'>bl_corners</span>, <span class='kw'>align</span> <span class='kw'>=</span> <span class='st'>"bottom_left"</span>)</div><div class='output co'>#&gt; # A tibble: 4 x 6
#&gt;   corner_row corner_col cells            data_type character numeric
#&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;list&gt;           &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
#&gt; 1          4          4 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 2          9          1 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 3          9          4 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 4         14          1 &lt;tibble [8 × 5]&gt; character Male           NA</div><div class='input'><span class='fu'>partition</span>(<span class='no'>multiples</span>, <span class='no'>bl_corners</span>, <span class='kw'>align</span> <span class='kw'>=</span> <span class='st'>"bottom_left"</span>, <span class='kw'>strict</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; # A tibble: 4 x 6
#&gt;   corner_row corner_col cells            data_type character numeric
#&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;list&gt;           &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
#&gt; 1          4          4 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 2          9          1 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 3          9          4 &lt;tibble [8 × 5]&gt; character Male           NA
#&gt; 4         14          1 &lt;tibble [8 × 5]&gt; character Male           NA</div><div class='input'><span class='co'># Given a set of cells in rows 1 to 10, partition them at the 3rd, 5th and 7th</span>
<span class='co'># rows.</span>
<span class='fu'>partition_dim</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>7</span>))</div><div class='output co'>#&gt;  [1] NA NA  3  3  5  5  7  7  7  7</div><div class='input'>
<span class='co'># Given a set of cells in columns 1 to 10, partition them at the 3rd, 5th and</span>
<span class='co'># 7th column.  This example is exactly the same as the previous one, to show</span>
<span class='co'># that the function works the same way on columns as rows.</span>
<span class='fu'>partition_dim</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>7</span>))</div><div class='output co'>#&gt;  [1] NA NA  3  3  5  5  7  7  7  7</div><div class='input'>
<span class='co'># Given a set of cells in rows 1 to 10, partition them at the 3rd, 5th and</span>
<span class='co'># 7th rows, aligned to the bottom of the group.</span>
<span class='fu'>partition_dim</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>7</span>), <span class='kw'>bound</span> <span class='kw'>=</span> <span class='st'>"lower"</span>)</div><div class='output co'>#&gt;  [1]  3  3  3  5  5  7  7 NA NA NA</div><div class='input'>
<span class='co'># Non-integer row/column numbers and cutpoints can be used, even though they</span>
<span class='co'># make no sense in the context of partioning grids of cells.  They are</span>
<span class='co'># rounded towards zero first.</span>
<span class='fu'>partition_dim</span>(<span class='fl'>1</span>:<span class='fl'>10</span> - <span class='fl'>.5</span>, <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>7</span>))</div><div class='output co'>#&gt;  [1] NA NA NA  3  3  5  5  7  7  7</div><div class='input'><span class='fu'>partition_dim</span>(<span class='fl'>1</span>:<span class='fl'>10</span>, <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>7</span>) + <span class='fl'>1.5</span>)</div><div class='output co'>#&gt;  [1] NA NA NA NA  4  4  6  6  8  8</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#functions">Functions</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Duncan Garmonsway.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

